See hessian DTFE equivalent for details on code
